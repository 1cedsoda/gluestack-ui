import { Canvas, Meta, Story } from '@storybook/addon-docs';

<Meta title="components/Modal" />

import { AccessibleModal, CloseIcon } from './Modal';
import { Wrapper } from '../Wrapper';

import { useState } from 'react';

import {
  AppProvider,
  CodePreview,
  Table,
  Text,
} from '@gluestack/design-system';

import { Pressable, Text as RNText } from 'react-native';

# Modal

A Modal is an overlay on the primary window or another dialog window. Content behind the modal dialog remains inert and users cannot interact with it.

<AppProvider>
  <CodePreview
    showComponentRenderer={true}
    showArgsController={false}
    metaData={{
      code: ` 
      function App () {
  const [showModal, setShowModal] = useState(false);
        return (
          <Wrapper>
         <Pressable onPress={() => setShowModal(true)}>
        <RNText>Click Me</RNText>
      </Pressable>
      <Modal
        isOpen={showModal}
        onClose={() => {
          setShowModal(false);
        }}
      >
        <Modal.Backdrop />
        <Modal.Content>
          <Modal.CloseButton>
            <CloseIcon sx={{ w: 16, h: 16 }} />
          </Modal.CloseButton>
          <Modal.Header>
            <RNText>Return Policy</RNText>
          </Modal.Header>
          <Modal.Body>
            <RNText>
              Create a 'Return Request' under "My Orders" section of App/Website. Follow the screens that come up after tapping on the 'Return' button. Please make a note of the Return ID that we generate at the end of the process. Keep the item ready for pick up or ship it to us basis on the return mode.
            </RNText>
          </Modal.Body>
          <Modal.Footer>
            <Pressable
              // variant="solid"
              onPress={() => {
                setShowModal(false);
              }}
            >
              <RNText>Cancel</RNText>
            </Pressable>
          </Modal.Footer>
        </Modal.Content>
      </Modal>
          </Wrapper>
    )
    }`,
      scope: {
        Modal: AccessibleModal,
        Wrapper,
        Pressable,
        useState,
        CloseIcon,
        RNText,
      },
      argsType: {},
    }}
  />
</AppProvider>

<br />

## Features

- Keyboard support for actions.
- Support for hover, focus and active states.

## Installation

```jsx
yarn add @universa11y/modal
```

## Usage

```jsx
import { createModal } from '@universa11y/modal';
const Modal = createModal({
  Root,
  Content,
  CloseButton,
  Header,
  Footer,
  Body,
  Backdrop,
});
```

These are the styled components that we need to pass in the creator API:

### Root

```jsx
const Root = styled(
  Pressable,
  {
    ...
  },
);
```

### Content

```jsx
import { styled } from '@dank-style/react';
const Content = styled(
  Text,
  {
    ...
  },
);
```

### CloseButton

```jsx
import { styled } from '@dank-style/react';
const CloseButton = styled(
  View,
  {
    ...
  },
);
```

### Header

```jsx
import { styled } from '@dank-style/react';
const Header = styled(
  ActivityIndicator,
  {
    ...
  },
);
```

### Footer

```jsx
import { styled } from '@dank-style/react';
const Footer = styled(
  View,
  {
    ...
  },
);
```

### Body

```jsx
import { styled } from '@dank-style/react';
const Body = styled(
  View,
  {
    ...
  },
);
```

### Backdrop

```jsx
import { styled } from '@dank-style/react';
const Backdrop = styled(
  View,
  {
    ...
  },
);
```

## Anatomy

```jsx
export default () => (
  <Modal>
    <Modal.Backdrop />
    <Modal.Content>
      <Modal.CloseButton></Modal.CloseButton>
      <Modal.Header></Modal.Header>
      <Modal.Body></Modal.Body>
      <Modal.Footer></Modal.Footer>
    </Modal.Content>
  </Modal>
);
```

## API Reference

### Modal

Contains all button related layout style props and actions.
It inherits all the properties of React Native's [Pressable](https://reactnative.dev/docs/pressable#props) component.

<AppProvider>
  <Table>
    <Table.THead sx={{ _dark: { bg: '$gray800' }, _light: { bg: '$gray100' } }}>
      <Table.TR>
        <Table.TH>
          <Text>Prop</Text>
        </Table.TH>
        <Table.TH>
          <Text>Type</Text>
        </Table.TH>
        <Table.TH>
          <Text>Default</Text>
        </Table.TH>
        <Table.TH>
          <Text>Description</Text>
        </Table.TH>
      </Table.TR>
    </Table.THead>
    <Table.TBody>
      <Table.TR>
        <Table.TD>
          <Text>isOpen</Text>
        </Table.TD>
        <Table.TD>
          <Text>boolean</Text>
        </Table.TD>
        <Table.TD>
          <Text>-</Text>
        </Table.TD>
        <Table.TD>
          <Text>
            If true, the modal will open. Useful for controllable state
            behavior.
          </Text>
        </Table.TD>
      </Table.TR>
      <Table.TR>
        <Table.TD>
          <Text>onClose</Text>
        </Table.TD>
        <Table.TD>
          <Text>{`() => any`}</Text>
        </Table.TD>
        <Table.TD>
          <Text>-</Text>
        </Table.TD>
        <Table.TD>
          <Text>Callback invoked when the modal is closed.</Text>
        </Table.TD>
      </Table.TR>
      <Table.TR>
        <Table.TD>
          <Text>useRNModal</Text>
        </Table.TD>
        <Table.TD>
          <Text>boolean</Text>
        </Table.TD>
        <Table.TD>
          <Text>false</Text>
        </Table.TD>
        <Table.TD>
          <Text>If true, renders react-native native modal.</Text>
        </Table.TD>
      </Table.TR>
      <Table.TR>
        <Table.TD>
          <Text>defaultIsOpen</Text>
        </Table.TD>
        <Table.TD>
          <Text>boolean</Text>
        </Table.TD>
        <Table.TD>
          <Text>-</Text>
        </Table.TD>
        <Table.TD>
          <Text>Specifies the default open state of the Modal.</Text>
        </Table.TD>
      </Table.TR>
      <Table.TR>
        <Table.TD>
          <Text>initialFocusRef</Text>
        </Table.TD>
        <Table.TD>
          <Text>{`React.RefObject<any>`}</Text>
        </Table.TD>
        <Table.TD>
          <Text>-</Text>
        </Table.TD>
        <Table.TD>
          <Text>The ref of element to receive focus when the modal opens.</Text>
        </Table.TD>
      </Table.TR>
      <Table.TR>
        <Table.TD>
          <Text>finalFocusRef</Text>
        </Table.TD>
        <Table.TD>
          <Text>{`React.RefObject<any>`}</Text>
        </Table.TD>
        <Table.TD>
          <Text>-</Text>
        </Table.TD>
        <Table.TD>
          <Text>The ref of element to receive focus when the modal closes</Text>
        </Table.TD>
      </Table.TR>
      <Table.TR>
        <Table.TD>
          <Text>avoidKeyboard</Text>
        </Table.TD>
        <Table.TD>
          <Text>boolean</Text>
        </Table.TD>
        <Table.TD>
          <Text>-</Text>
        </Table.TD>
        <Table.TD>
          <Text>If true, the Modal will avoid the keyboard.</Text>
        </Table.TD>
      </Table.TR>
      <Table.TR>
        <Table.TD>
          <Text>closeOnOverlayClick</Text>
        </Table.TD>
        <Table.TD>
          <Text>boolean</Text>
        </Table.TD>
        <Table.TD>
          <Text>-</Text>
        </Table.TD>
        <Table.TD>
          <Text>
            If true, the Modal will close when the overlay is clicked.
          </Text>
        </Table.TD>
      </Table.TR>
      <Table.TR>
        <Table.TD>
          <Text>isKeyboardDismissable</Text>
        </Table.TD>
        <Table.TD>
          <Text>boolean</Text>
        </Table.TD>
        <Table.TD>
          <Text>-</Text>
        </Table.TD>
        <Table.TD>
          <Text>If true, the keyboard can dismiss the Modal.</Text>
        </Table.TD>
      </Table.TR>
      <Table.TR>
        <Table.TD>
          <Text>animationPreset</Text>
        </Table.TD>
        <Table.TD>
          <Text>`'slide'` &#124; `'fade'`</Text>
        </Table.TD>
        <Table.TD>
          <Text>`'slide'`</Text>
        </Table.TD>
        <Table.TD>
          <Text>Specifies the animation preset for the Modal.</Text>
        </Table.TD>
      </Table.TR>
      <Table.TR>
        <Table.TD>
          <Text>contentSize</Text>
        </Table.TD>
        <Table.TD>
          <Text>any</Text>
        </Table.TD>
        <Table.TD>
          <Text>-</Text>
        </Table.TD>
        <Table.TD>
          <Text>Specifies the content size for the Modal.</Text>
        </Table.TD>
      </Table.TR>
      <Table.TR>
        <Table.TD>
          <Text>children</Text>
        </Table.TD>
        <Table.TD>
          <Text>any</Text>
        </Table.TD>
        <Table.TD>
          <Text>-</Text>
        </Table.TD>
        <Table.TD>
          <Text>The content to display inside the Modal.</Text>
        </Table.TD>
      </Table.TR>
    </Table.TBody>
  </Table>
</AppProvider>

### Modal.Backdrop

It inherits all the properties of React Native's [View](https://reactnative.dev/docs/view#props) component.

### Modal.CloseButton

It inherits all the properties of React Native's [View](https://reactnative.dev/docs/view#props) component.

### Modal.Header

It inherits all the properties of React Native's [View](https://reactnative.dev/docs/view#props) component.

### Modal.Body

It inherits all the properties of React Native's [View](https://reactnative.dev/docs/view#props) component.

### Modal.Footer

It inherits all the properties of React Native's [View](https://reactnative.dev/docs/view#props) component.

## Example

<AppProvider>
  <CodePreview
    showComponentRenderer={true}
    showArgsController={false}
    metaData={{
      code: ` 
      function App () {
  const [showModal, setShowModal] = useState(false);
        return (
          <Wrapper>
         <Pressable onPress={() => setShowModal(true)}>
        <RNText>Click Me</RNText>
      </Pressable>
      <Modal
        isOpen={showModal}
        onClose={() => {
          setShowModal(false);
        }}
      >
        <Modal.Backdrop />
        <Modal.Content>
          <Modal.CloseButton>
            <CloseIcon sx={{ w: 16, h: 16 }} />
          </Modal.CloseButton>
          <Modal.Header>
            <RNText>Return Policy</RNText>
          </Modal.Header>
          <Modal.Body>
            <RNText>
              Create a 'Return Request' under "My Orders" section of App/Website. Follow the screens that come up after tapping on the 'Return' button. Please make a note of the Return ID that we generate at the end of the process. Keep the item ready for pick up or ship it to us basis on the return mode.
            </RNText>
          </Modal.Body>
          <Modal.Footer>
            <Pressable
              // variant="solid"
              onPress={() => {
                setShowModal(false);
              }}
            >
              <RNText>Cancel</RNText>
            </Pressable>
          </Modal.Footer>
        </Modal.Content>
      </Modal>
          </Wrapper>
    )
    }`,
      scope: {
        Modal: AccessibleModal,
        Wrapper,
        Pressable,
        useState,
        CloseIcon,
        RNText,
      },
      argsType: {},
    }}
  />
</AppProvider>

## Accessibility

Uses React Native ARIA [@react-native-aria/focus](https://react-native-aria.geekyants.com/docs/FocusScope) which follows the [Dialog Modal WAI-ARIA design pattern](https://www.w3.org/WAI/ARIA/apg/#dialog_modal)
.

## Dependencies

- `@universa11y/utils`
- `@react-native-aria/focus`
- `react-native-svg`
- `@universa11y/hooks`
- `@universa11y/icon`
- `@universa11y/overlay`
- `@universa11y/react-native-aria`
- `@universa11y/transitions`
