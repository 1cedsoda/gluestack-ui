---
title: Animation Plugin | Dank
description: Learn to add animation props with Dankâ€™s Animation Plugin for dynamic, animated UI elements. Performance impacts and lack of typings are limitations.
canonical: https://dank.style/
---

import { Canvas, Meta, Story } from '@storybook/addon-docs';
import { Pressable, Text, View } from 'react-native';
import { useEffect, useState, useRef } from 'react';
import { Motion } from '@legendapp/motion';
import { Button, AppProvider, CodePreview } from '@gluestack/design-system';
import { config } from '../../components/nb.config';
import { createStyled, StyledProvider } from '@dank-style/react';
import { AnimationResolver } from '@dank-style/animation-plugin';

<Meta title="plugins/Animation Plugin" />

# Animation Plugin

Dank provides a Plugin to add support for Animation props using Animation Libraries like [@legendapp/motion](https://legendapp.com/open-source/motion/), [framer-motion](https://www.framer.com/motion/), and [moti](https://moti.fyi/). We will use `@legendapp/motion` in this example.

### Installation:

```bash
# using npm

npm install @dank-style/animation-plugin

# using yarn

yarn add @dank-style/animation-plugin
```

## How to use:

1. Initialization of the plugin:

- The Animation plugin can be initialized by creating a new instance of the `AnimationResolver` class and passing it to the `createStyled` function as an argument. The `AnimationResolver` takes an optional `styledUtils` object that maps the styled utils object. Here's an example:

> By default plugin aliases `@legendapp/motion` props.

```jsx
import { createStyled } from '@dank-style/react';
import { AnimationResolver } from '@dank-style/animation-plugin';

const styled = createStyled([
  new AnimationResolver({
    aliases: {
      ':initial': 'initial',
      ':animate': 'animate',
      ':exit': 'exit',
    },
  }),
]);
```

- In this example, we're creating a new instance of the AnimationResolver class and passing an object with the aliases property as an argument. The aliases object maps the aliases :initial, :animate, and :exit to their corresponding animation props.

2. Example of styled component creation:

- Once the plugin is initialized, you can use the `styled` function to create styled components with animation props. Here's an example:

```jsx
const Box = styled(Motion.View, {
  ':initial': { opacity: 0 },
  ':animate': { opacity: 1 },
  ':exit': { opacity: 0 },
});
```

Final internal styled object that will be resolved styled

```jsx
styledObject = {
  'props': {
    initial: {
      opacity: 0,
    },
    animate: {
      opacity: 1,
    },
    exit: {
      opacity: 0,
    },
    }
  },
};
```

## Example:

<AppProvider>
  <CodePreview
    showArgsController={false}
    metaData={{
      scope: {
        createStyled,
        AnimationResolver,
        Provider: StyledProvider,
        config,
        Pressable,
        Text,
        Motion,
        useEffect,
        useState,
        useRef,
        Motion,
      },
      code: `
<StyledMotionView
  states={{ hover: hover }}>
  <StyledText>Hover Me!</StyledText>
</StyledMotionView>`,
      transformCode: (code) => `
          function App(){
            const styledAnimated = createStyled([new AnimationResolver({})]);
            const StyledMotionViewRef = React.useRef(styledAnimated(
              Motion.View,
              {
                'w': 100,
                'h': 50,
                'bg': '$blue600',
                'p': '$2',
                alignItems: 'center',
                justifyContent: 'center',
                rounded: '$md',
                ':animate': {
                  scale: 1,
                  opacity: 0.9,
                },
                ':hover': {
                  ':animate': {
                    scale: 1.1,
                    opacity: 1,
                  },
                },
                _text: {
                  color: '$black',
                  fontSize: '$md',
                  _dark: {
                    color: '$white',
                  },
                }
                
              },
              {
                descendantStyle: ['_text'],
              },
            ));
            const StyledMotionView = StyledMotionViewRef.current;
            const StyledText = styledAnimated(
              Motion.Text,
              {},
              {
                ancestorStyle: ['_text'],
              },
            );
            const [ hover, setHover ] = React.useState(false);
            const ref = React.useRef();
              React.useEffect(() => {
              if (ref && ref.current) {
                ref.current.addEventListener('mouseover', () => {
                  setHover(true);
                });
                ref.current.addEventListener('mouseleave', () => {
                  setHover(false);
                });
              }
            }, []);
            return ( 
              <Provider config={config}>
               <div ref={ref}>
                ${code}
              </div>
              </Provider>
            );
          }
      `,
    }}
  />
</AppProvider>

```jsx
const styledAnimated = createStyled([new AnimationResolver({})]);
const StyledMotionView = styledAnimated(
  Motion.View,
  {
    'w': 100,
    'h': 200,
    'bg': '$blue500',
    ':initial': { y: -150 },
    ':animate': {
      opacity: 0.5,
      y: 50,
      scale: 1,
    },
    ':hover': {
      ':animate': {
        opacity: 1,
      },
    },
  },
  {
    descendantStyle: ['_text'],
  }
);
```

3. Wrapper component for exit animation:

- The Animation plugin provides a wrapper component called `AnimatePresence` from [@legendapp/motion](https://legendapp.com/open-source/motion/) that checks if any component is removed from the React tree or not so that it can help with exit animation. Here's an example:

> If you are using @legendapp/motion, you can use styled.Component, which internally uses AnimatePresence from @legendapp/motion, otherwise you should use `AnimatePresence` or something similar(which animates component on exit) from your library.

```jsx
function App() {
  const [show, setShow] = useState(false);

  return <styled.Component>{show && <Box />}</styled.Component>;
}
```

In this example, we're using the `styled.Component` component provided by the Animation plugin to wrap the Box component which internally uses `AnimatePresence` from [@legendapp/motion](https://legendapp.com/open-source/motion/). The AnimatePresence component checks if the Box component is removed from the React tree or not so that it can help with exit animation.

<AppProvider>
  <CodePreview
    showArgsController={false}
    metaData={{
      scope: {
        createStyled,
        AnimationResolver,
        Provider: StyledProvider,
        config,
        Pressable,
        Motion,
        Text,
        View,
      },
      code: `
<styled.Component>{show && <StyledBox />}</styled.Component>`,
      transformCode: (code) => `
          function App(){
            const styled = createStyled([new AnimationResolver()]);
            const StyledBox = styled(
              Motion.View,
              {
                'w': '$20',
                'h': '$20',
                rounded: '$md',
                'bg': '$blue500',
                ':initial': {
                  opacity: 0,
                  scale: 0.5,
                },
                ':animate': {
                  opacity: 1,
                  scale: 1,
                },
                ':exit': {
                  opacity: 0,
                  scale: 0.5,
                },
              },
            );
            const [show, setShow] = React.useState(true);
            return ( 
              <Provider config={config}>
              <Pressable onPress={() => setShow(!show)} style={{backgroundColor: 'red', padding: 8, borderRadius: 4, marginBottom: 8, alignItems: 'center'}}>
                <Text style={{color: 'white'}}>{show ? 'Unmount' : 'Mount'}</Text>
              </Pressable>
                ${code}
              </Provider>
            );
          }
      `,
    }}
  />
</AppProvider>

### Limitations:

- We are converting user styled object to internal styled object through input middleware that is heavy task and will affect performance.
- Typings are not yet supported for animation props
